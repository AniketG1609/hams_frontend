<div class="flex justify-between items-center mb-8 bg-white p-4 rounded-lg shadow">
  <h1 class="text-2xl font-bold text-gray-800">Hello, {{ patient?.name || 'Patient' }}</h1>

  <div class="flex items-center gap-4">
    <div class="relative">
      <button
        (click)="toggleNotifications()"
        class="bg-gray-100 w-12 h-12 rounded-full flex items-center justify-center text-xl hover:bg-gray-200 transition"
      >
        <span class="leading-none">ðŸ””</span>

        @if (notificationCount > 0) {
        <span
          class="absolute top-0.5 right-0.5 bg-red-500 text-white text-xs font-bold w-5 h-5 flex items-center justify-center rounded-full border-2 border-white"
        >
          {{ notificationCount }}
        </span>
        }
      </button>

      @if (showNotifications) {
      <div
        class="absolute right-0 mt-3 w-96 bg-white rounded-xl shadow-lg max-h-96 overflow-y-auto z-50"
      >
        <div class="flex justify-between items-center p-4 border-b">
          <h3 class="font-semibold text-gray-800">Notifications</h3>
          <button (click)="markAllAsRead()" class="text-blue-600 text-sm font-medium">
            Mark all as read
          </button>
        </div>

        @if (loadingNotifications) {
        <div class="p-4 text-center text-gray-500">Loading notifications...</div>
        } @else if (notifications.length === 0) {
        <div class="p-4 text-center text-gray-500">You have no new notifications.</div>
        } @else {
        <div class="divide-y divide-gray-200">
          @for (notification of notifications; track notification.id) {
          <div class="p-4 cursor-pointer hover:bg-gray-50" [class.bg-blue-50]="!notification.read">
            <h4 class="font-semibold text-gray-800">{{ notification.title }}</h4>
            <p class="text-gray-600 text-sm">
              {{ notification.message }}
            </p>
            <span class="text-gray-400 text-xs">{{ notification.createdAt | date : 'short' }}</span>
          </div>
          }
        </div>
        }
      </div>
      }
    </div>
    <div class="relative">
      <div
        (click)="toggleProfile()"
        class="flex items-center gap-3 bg-gray-100 p-2 rounded-lg cursor-pointer hover:bg-gray-200 transition"
      >
        <div
          class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 text-white font-semibold flex items-center justify-center"
        >
          {{ getInitials(patient?.name) }}
        </div>
        <div class="text-left">
          <div class="font-semibold text-gray-800 text-sm">{{ patient?.name || 'Patient' }}</div>
          <div class="text-gray-500 text-xs">Patient ID: P{{ patient?.patientId }}</div>
        </div>
        <span class="text-gray-500 text-xs">â–¼</span>
      </div>

      @if (showProfile) {
      <div class="absolute right-0 mt-3 w-56 bg-white rounded-xl shadow-lg z-50">
        <a
          (click)="openProfile()"
          class="flex items-center gap-2 p-3 hover:bg-gray-100 cursor-pointer"
        >
          ðŸ‘¤ My Profile
        </a>
        <a
          (click)="logout()"
          class="flex items-center gap-2 p-3 text-red-600 hover:bg-gray-100 cursor-pointer"
          >ðŸšª Logout</a
        >
      </div>
      }
    </div>
  </div>
</div>
